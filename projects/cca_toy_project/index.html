<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Cannonical Component Analysis on sample datasets | Pearl Ayem</title> <meta name="author" content="Pearl Ayem"> <meta name="description" content="Skills- sklearn, scipy, seaborn, CCA, statistics"> <meta name="keywords" content="data-modelling, climate-change, net-zero, esg, sustainability,"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.ico"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://pearl-ayem.github.io/projects/cca_toy_project/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Pearl Ayem</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About Me</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Data Science Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">Curriculum Vitae</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Cannonical Component Analysis on sample datasets</h1> <p class="post-description">Skills- sklearn, scipy, seaborn, CCA, statistics</p> </header> <article> <h1 id="introduction">Introduction</h1> <p>Canonical correlation analysis is used to identify and measure the associations among two sets of variables. Canonical correlation is appropriate in the same situations where multiple regression would be, but where are there are multiple intercorrelated outcome variables</p> <p>The goal of this toy project was to use new statistical and visualization libraries to conduct CCA on sample datasets. The libraries and functions used in this project include: scikit-learn and scipy for linear decomposition and conducting Canonical Componenet Analysis and seaborn for new visualization tecniques.</p> <p>I will try to perform canonical correlation analysis (CCA) between the two datasets X and Y. Dataset X contains time series x1, x2, x3, and dataset Y contains time series y1, y2, y3. <br> The following analysis was done: <br></p> <h2 id="a-load-cca-dataset-and-split-into-the-x-and-y-data-to-carry-out-analysis">a) Load CCA dataset, and split into the X and Y data to carry out analysis</h2> <p>Original Data</p> <table> <thead> <tr> <th style="text-align: center">x1</th> <th style="text-align: center">x2</th> <th style="text-align: center">x3</th> <th style="text-align: center">y1</th> <th style="text-align: center">y2</th> <th style="text-align: center">y3</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">1.530845</td> <td style="text-align: center">0.316551</td> <td style="text-align: center">-1.823282</td> <td style="text-align: center">1.215005</td> <td style="text-align: center">1.273343</td> <td style="text-align: center">0.026177</td> </tr> <tr> <td style="text-align: center">1.285960</td> <td style="text-align: center">0.823623</td> <td style="text-align: center">-1.389774</td> <td style="text-align: center">1.579516</td> <td style="text-align: center">0.621029</td> <td style="text-align: center">0.804732</td> </tr> <tr> <td style="text-align: center">0.106213</td> <td style="text-align: center">0.578572</td> <td style="text-align: center">0.564672</td> <td style="text-align: center">-0.018080</td> <td style="text-align: center">-1.103449</td> <td style="text-align: center">1.082170</td> </tr> <tr> <td style="text-align: center">-0.937513</td> <td style="text-align: center">0.040444</td> <td style="text-align: center">1.064561</td> <td style="text-align: center">-1.748572</td> <td style="text-align: center">-1.387991</td> <td style="text-align: center">-0.676495</td> </tr> <tr> <td style="text-align: center">-1.516770</td> <td style="text-align: center">-1.462519</td> <td style="text-align: center">1.001928</td> <td style="text-align: center">-0.673814</td> <td style="text-align: center">0.430090</td> <td style="text-align: center">-1.128205</td> </tr> </tbody> </table> <p><br></p> <blockquote> <p>Data is split into X and Y</p> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n1</span><span class="p">,</span><span class="n">n2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">shape</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">xdata</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># xdata has three variables, 200 observations
</span><span class="n">ydata</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">3</span><span class="p">:]</span>  <span class="c1"># ydata has three variables, 200 observations
</span><span class="n">t</span> <span class="o">=</span> <span class="nf">range</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
</code></pre></div></div> <p><br></p> <h2 id="b-plot-the-time-series-in-2-d-space">b) Plot the time series in 2-D space</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">x1</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">x2</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">x3</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">ydata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">y1</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">ydata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">y2</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">ydata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">y3</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <p><br></p> <div class="row"> <div class="col-sm"> <figure> <picture> <img src="/assets/img/cca_1.png" class="img-fluid z-depth-1" width="auto" height="auto" title="CCA 1" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><br></p> <h2 id="c-plot-the-time-series-in-3-d-space">c) Plot the time series in 3-D space</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="sh">'</span><span class="s">3d</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">xdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">xdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">x space</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="sh">'</span><span class="s">3d</span><span class="sh">'</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">ydata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">ydata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">ydata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">y space</span><span class="sh">'</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">cbar</span><span class="p">.</span><span class="nf">set_label</span><span class="p">(</span><span class="sh">'</span><span class="s">time</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="row"> <div class="col-sm"> <figure> <picture> <img src="/assets/img/cca_2.png" class="img-fluid z-depth-1" width="auto" height="auto" title="CCA 2" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><br></p> <h2 id="d-perform-cca-on-the-dataset-and-plot-output">d) Perform CCA on the dataset and plot output.</h2> <blockquote> <p>To perform PCA I normalized the data, then used the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cross_decomposition.CCA.html" rel="external nofollow noopener" target="_blank">CCA</a> function from sklearn library.</p> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n_modes</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1">#modes to keep
</span><span class="n">cca</span> <span class="o">=</span> <span class="nc">CCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_modes</span><span class="p">,</span><span class="n">max_iter</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">U</span><span class="p">,</span><span class="n">V</span> <span class="o">=</span> <span class="n">cca</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="n">ydata</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">cca</span><span class="p">.</span><span class="n">x_weights_</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">cca</span><span class="p">.</span><span class="n">y_weights_</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">cov</span><span class="p">(</span><span class="n">xdata</span><span class="p">.</span><span class="n">T</span><span class="p">)</span><span class="nd">@A</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">cov</span><span class="p">(</span><span class="n">ydata</span><span class="p">.</span><span class="n">T</span><span class="p">)</span><span class="nd">@B</span>
<span class="n">r</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="nf">corrcoef</span><span class="p">(</span><span class="n">U</span><span class="p">[:,</span><span class="n">ii</span><span class="p">],</span><span class="n">V</span><span class="p">[:,</span><span class="n">ii</span><span class="p">])</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n_modes</span><span class="p">)]</span>


<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n_modes</span><span class="p">):</span>
    
    <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="n">n_modes</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">kk</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">F</span><span class="p">[:,</span><span class="n">kk</span><span class="p">])</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">F: Mode </span><span class="sh">'</span> <span class="o">+</span> <span class="nf">str</span><span class="p">(</span><span class="n">kk</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    
    <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="n">n_modes</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">kk</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">G</span><span class="p">[:,</span><span class="n">kk</span><span class="p">])</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">G: Mode </span><span class="sh">'</span> <span class="o">+</span> <span class="nf">str</span><span class="p">(</span><span class="n">kk</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    
    <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="n">n_modes</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">kk</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">U</span><span class="p">[:,</span><span class="n">kk</span><span class="p">])</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">V</span><span class="p">[:,</span><span class="n">kk</span><span class="p">])</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">U and V: r = </span><span class="sh">'</span> <span class="o">+</span> <span class="nf">str</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">kk</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">([</span><span class="sh">'</span><span class="s">U</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">V</span><span class="sh">'</span><span class="p">])</span>
    
<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

<span class="n">FM1</span><span class="o">=</span><span class="n">F</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#Mode 1
</span><span class="n">FM2</span><span class="o">=</span><span class="n">F</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>  <span class="c1">#Mode 2
</span><span class="n">FM3</span><span class="o">=</span><span class="n">F</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>  <span class="c1">#Mode 3
</span>
<span class="n">GM1</span><span class="o">=</span><span class="n">G</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#Mode 1
</span><span class="n">GM2</span><span class="o">=</span><span class="n">G</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>  <span class="c1">#Mode 2
</span><span class="n">GM3</span><span class="o">=</span><span class="n">G</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>  <span class="c1">#Mode 3
</span></code></pre></div></div> <p><br> F: <br> [[ 0.00446775 | 1.38448709 | 0.74085775]<br> [ 0.36774811 | 1.18278841 | 0.65839886]<br> [ 0.35360286 | -1.20036722 | -0.64154713]] <br> <br> G: <br> [[-0.60781613 | 1.04238248 | -0.11125062]<br> [-1.21694479 | -0.0053953 | 0.14002947]<br> [ 0.62447444 | 1.02810331 | -0.23102376]] <br></p> <div class="row"> <div class="col-sm"> <figure> <picture> <img src="/assets/img/cca_3.png" class="img-fluid z-depth-1" width="auto" height="auto" title="CCA 3" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><br></p> <h2 id="e-plot-vectors-that-correspond-to-the-modes-of-high-correlation-in-the-3-d-x-space-and-in-the-3-d-y-space">e) Plot vectors that correspond to the modes of high correlation in the 3-D x-space and in the 3-D y-space</h2> <blockquote> <p>Plot vector F1 and vector F2 in x-space, and G1 and G2 in y-space since the first 2 modes have high correlation The black arrows are F1 and G1 which represent Mode 1 of the CCA, and blue arrows (F2 and G2) represent Mode 2. <br></p> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="sh">'</span><span class="s">3d</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">xdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">xdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">quiver</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">FM1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">FM1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">FM1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">length</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">)</span>    <span class="c1">#vector F1
</span><span class="n">ax</span><span class="p">.</span><span class="nf">quiver</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">FM2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">FM2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">FM2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">length</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>    <span class="c1">#vector F2
</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">x space</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="sh">'</span><span class="s">3d</span><span class="sh">'</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">ydata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">ydata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">ydata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">quiver</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">GM1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">GM1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">GM1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">length</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">)</span>    <span class="c1">#vector G1
</span><span class="n">ax</span><span class="p">.</span><span class="nf">quiver</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">GM2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">GM2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">GM2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">length</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>    <span class="c1">#vector G2
</span><span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">y space</span><span class="sh">'</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">cbar</span><span class="p">.</span><span class="nf">set_label</span><span class="p">(</span><span class="sh">'</span><span class="s">time</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <p><br></p> <div class="row"> <div class="col-sm"> <figure> <picture> <img src="/assets/img/cca_4.png" class="img-fluid z-depth-1" width="auto" height="auto" title="CCA 4" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><br></p> <h2 id="f-plot-ut-vs-vt-where-u-is-the-canonical-scores-of-the-x-data-and-v-is-the-canonnical-scores-of-the-y-data">f) Plot U(t) vs V(t) where U is the canonical scores of the X data and V is the canonnical scores of the Y data</h2> <p><br></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">flatui</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">#95a5a6</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">#34495e</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">#e74c3c</span><span class="sh">"</span><span class="p">]</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">set_palette</span><span class="p">(</span><span class="n">flatui</span><span class="p">)</span>

<span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">U</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">V</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">D</span><span class="sh">'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">0.9</span><span class="sh">"</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="p">.</span><span class="mi">75</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">U</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">V</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">+</span><span class="sh">'</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="p">.</span><span class="mi">75</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">U</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">V</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">1</span><span class="sh">"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="p">.</span><span class="mi">75</span><span class="p">)</span>    
    
<span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode 1</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">Mode 2</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">Mode 3</span><span class="sh">'</span><span class="p">]</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s"> U(t) versus V(t)</span><span class="sh">'</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">U(t)</span><span class="sh">'</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">V(t)</span><span class="sh">'</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>    
<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span> 
</code></pre></div></div> <blockquote> <p>Mode 1 has the highest r value of 0.98 and hence the highest correlation. This is seen in the plot below (grey diamonds), where the data points for Mode 1 show the smallest deviation and follow a narrow positively increasing trend. The second significant mode is Mode 2 (r=0.91). It has some more spread than Mode 1 (the + markers) but still shows a positive correlation between the U and V markers. Mode 3 is just a cluster in one spot, and shows lowest correlation as predicted by the r value of 0.11. It does not follow any linear trends.</p> </blockquote> <p><br></p> <div class="row"> <div class="col-sm"> <figure> <picture> <img src="/assets/img/cca_5.png" class="img-fluid z-depth-1" width="auto" height="auto" title="CCA 5" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><br></p> <h2 id="g-plot-f-only-the-significant-modes-in-2-d-eg-x1-vs-x2-x1-vs-x3-x2-vs-x3-to-see-whether-the-vectors-f-ie-f1-f2--point-in-the-same-direction-as-pca-eigenvectors-of-this-dataset-investigate-the-same-for-g-in-y-space">g) Plot F (only the significant modes) in 2-D (e.g. x1 vs x2; x1 vs x3; x2 vs x3) to see whether the vectors F (i.e. F1, F2, …) point in the same direction as PCA eigenvectors of this dataset. Investigate the same for G in y-space</h2> <blockquote> <p>In order to investigate this I carried out PCA on the T and x datasets so that CCA is finding modes which explain non-negligible fractions of total variance. <br></p> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pca_input_x</span> <span class="o">=</span> <span class="n">xdata</span>
<span class="n">n_modes_x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">min</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">shape</span><span class="p">(</span><span class="n">xdata</span><span class="p">))</span>
<span class="n">pca_x</span> <span class="o">=</span> <span class="nc">PCA</span><span class="p">(</span><span class="n">n_components</span> <span class="o">=</span> <span class="n">n_modes_x</span><span class="p">)</span>
<span class="n">PCs_x</span> <span class="o">=</span> <span class="n">pca_x</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">pca_input_x</span><span class="p">)</span>
<span class="n">eigvecs_x</span> <span class="o">=</span> <span class="n">pca_x</span><span class="p">.</span><span class="n">components_</span>
<span class="n">fracVar_x</span> <span class="o">=</span> <span class="n">pca_x</span><span class="p">.</span><span class="n">explained_variance_ratio_</span>
</code></pre></div></div> <p><br></p> <blockquote> <p>The same PCA method as above was carried out on the y datasets <br></p> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pca_input_y</span> <span class="o">=</span> <span class="n">ydata</span>
<span class="n">n_modes_y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">min</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">shape</span><span class="p">(</span><span class="n">ydata</span><span class="p">))</span>
<span class="n">pca_y</span> <span class="o">=</span> <span class="nc">PCA</span><span class="p">(</span><span class="n">n_components</span> <span class="o">=</span> <span class="n">n_modes_y</span><span class="p">)</span>
<span class="n">PCs_y</span> <span class="o">=</span> <span class="n">pca_y</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">pca_input_y</span><span class="p">)</span>
<span class="n">eigvecs_y</span> <span class="o">=</span> <span class="n">pca_y</span><span class="p">.</span><span class="n">components_</span>
<span class="n">fracVar_y</span> <span class="o">=</span> <span class="n">pca_y</span><span class="p">.</span><span class="n">explained_variance_ratio_</span>
</code></pre></div></div> <blockquote> <p>When I plot the eigen vectors from the PCA and the significant modes from the CCA in the same plot, the plots in the x-space have the vectors lining up perfectly, which indicates that they explain a lot of the variance in the x-space and are highly correlated. The vectors in the y-space are less correlated. Even though some remain in the direction of the variance, there is less correlation between the modes. This would suggest that overall there is larger variance in the x space.</p> </blockquote> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets%5Cimg%5Ccca_6.png" class="img-fluid z-depth-1" width="auto" height="auto" title="CCA 6" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Red arrows are F1, Blue arrows are F2, Black arrows are Eigen Mode 1 and Green arrows are Eigen Mode 2. </div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Pearl Ayem. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>